<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Generador de Marca País &mdash; El Salvador</title>
  <meta name="description" content="Generador de Marca país El Salvador">
  <meta property="og:title" content="Generador de Marca País &mdash; El Salvador" />
  <meta property="og:description" content="Generador de Marca país El Salvador" />
  <meta property="og:image" content="img/share-marca-pais.png" />
  <meta property="og:url" content="" />
  <meta property="og:site_name" content="Generador Marca País" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@ricardoerl" />
  <meta name="twitter:creator" content="@ricardoerl" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.7.9/fabric.min.js"></script>
  <style media="screen">
    @font-face {
      font-family: 'Grenale2NormDemi';
      src: url('font/Grenale2NormDemi-webfont.woff2') format('woff2'),
           url('font/Grenale2NormDemi-webfont.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }
    .canvas-container { margin: 0 auto; }
  </style>
</head>
<body>
  <div id="app" class="vh-100 dt w-100">
    <div class="dtc v-mid tc white">
      <canvas width="1280" height="640" id="app-canvas" style="font-family: 'Grenale2NormDemi';"></canvas>
      <div class="mt6">
        <button id="app-button" class="f3 bg-green white pv3 ph5 bn br2 pointer grow">Guardar imagen</button>
        <p class="silver">Hecho por <a href="http://ricardoerl.com/" target="_blank" class="link green">Ricardo Ramírez</a></p>
      </div>
    </div>
  </div>
  <script>

    // Initial setup
    var canvas = new fabric.Canvas('app-canvas'),
        canvasBackground = 'http://i.imgur.com/r4x7gcS.png',
        canvasText = '',
        canvasButton = document.getElementById('app-button'),
        canvasTextOptions = {
          width: 800,
          left: 375,
          top: 400,
          fontSize: 60,
          fontFamily: 'Grenale2NormDemi',
          fontWeight: 'bold',
          lineHeight: 1,
          textAlign: 'center',
          fill: '#07A7E1',
          hasControls: false,
          lockMovementX: true,
          lockMovementY: true,
          lockScalingX: true,
          hasBorders: false,
          breakWords: true
        };

    // Add background image
    fabric.Image.fromURL(canvasBackground, function(img) {
      canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));
    }, { crossOrigin: 'Anonymous' });

    // Add button listener
    canvasButton.addEventListener('click', saveImage);

    window.onload = function() {
      // Add text
      var fabricText = new fabric.Textbox(canvasText, canvasTextOptions);
      canvas.add(fabricText);
      canvas.setActiveObject(fabricText);
      fabricText.centerH();
      fabricText.enterEditing();
    };

    // Save Image
    function saveImage (event) {
      var canvas = document.getElementById("app-canvas"),
          ctx = canvas.getContext("2d");
      canvas.toBlob(function(blob) {
          saveAs(blob, "marca-pais.png");
      });
    }

  </script>
  <link rel="stylesheet" href="https://unpkg.com/tachyons@4.7.0/css/tachyons.min.css">
  <script src="https://unpkg.com/file-saver@1.3.3/FileSaver.min.js"></script>
</body>
</html>
